<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #080808; color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        
        .container {
            background: #111;
            padding: 4rem;
            border-radius: 40px;
            border: 2px solid #222;
            text-align: center;
            transition: all 0.5s ease; /* Işık geçiş yumuşaklığı */
        }

        .label { color: #666; text-transform: uppercase; letter-spacing: 4px; font-size: 0.9rem; margin-bottom: 20px; }
        
        .price { font-size: 5rem; font-weight: 900; margin: 0; }

        /* YÜKSELİŞ: Yeşil Transparan Işık */
        .up { 
            border-color: rgba(0, 255, 127, 0.4) !important;
            box-shadow: 0 0 60px rgba(0, 255, 127, 0.2);
            color: #00ff7f;
        }

        /* DÜŞÜŞ: Kırmızı Transparan Işık */
        .down { 
            border-color: rgba(255, 71, 87, 0.4) !important;
            box-shadow: 0 0 60px rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }
    </style>
</head>
<body>

    <div id="box" class="container">
        <div class="label">Has Altın Satış</div>
        <div id="display" class="price">Yükleniyor...</div>
    </div>

    <script>
        let lastPrice = 0;

        async function update() {
            try {
                const res = await fetch('http://localhost:3000/api/altin');
                const data = await res.json();
                const priceStr = data.fiyat;
                
                // Sayısal karşılaştırma için temizlik (2.850,50 -> 2850.50)
                const currentPrice = parseFloat(priceStr.replace('.', '').replace(',', '.'));
                
                const box = document.getElementById('box');
                const display = document.getElementById('display');

                display.innerText = priceStr + " TL";

                if (lastPrice !== 0 && currentPrice !== lastPrice) {
                    if (currentPrice > lastPrice) {
                        box.className = "container up";
                    } else {
                        box.className = "container down";
                    }
                }

                lastPrice = currentPrice;

                // 3 saniye sonra efekt sönükleşsin
                setTimeout(() => {
                    box.className = "container";
                    display.style.color = "white";
                }, 3000);

            } catch (e) {
                document.getElementById('display').innerText = "Sunucu Kapalı!";
            }
        }

        setInterval(update, 5000); // 5 saniyede bir güncelle
        update();
    </script>
</body>
</html>
